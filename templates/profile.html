{% extends "layout.html" %}

{% block title %}{{ user.username }}'s Profile{% endblock %}

{% block content %}
    <!-- Profile Header -->
    <div class="profile-header">
        <h1>{{ user.username }}'s Profile</h1>
    </div>

    <!-- Main Container -->
    <div class="container profile-container">
        
        <!-- About Me Card -->
        <div class="about-me-card">
            <h3>About Me</h3>
            <p>{{ user.about_me if user.about_me else "This user has not written anything about themselves yet." }}</p>
        </div>

        <!-- Last Active Section -->
        <div class="last-active">
            <h3>Last Active</h3>
            <p>Active {{ (datetime.datetime.utcnow() - user.last_active).seconds }} seconds ago</p>
        </div>

        <!-- Edit About Me Section -->
        <div class="edit-about-me-form">
            <h3>Edit About Me</h3>
            <form method="POST" action="{{ url_for('update_about_me') }}">
                <textarea name="about_me" maxlength="500" rows="4">{{ user.about_me }}</textarea><br>
                <input type="submit" value="Update">
            </form>
        </div>
        
        <!-- Race List Section -->
        <div class="race-list">
            <h3>My Race List</h3>
            <ul>
                {% for race in user.races %}
                    <li>
                        <strong>{{ race.race_name }}</strong> - {{ race.race_distance }} on {{ race.race_date }}
                        <form method="POST" action="{{ url_for('remove_race_from_profile', race_id=race.id) }}">
                            <button type="submit">Remove</button>
                    </form>
                    </li>
                {% else %}
                    <li>You have no races in your list.</li>
                {% endfor %}
            </ul>
        </div>
    
    </div>
{% endblock %}